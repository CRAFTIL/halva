@echo off
set "IMG=%USERPROFILE%\cat.jpg"
set "URL=https://az-market.net/tn_Cat_495623_3876.jpg"

if not exist "%IMG%" (
    powershell -Command "try { Invoke-WebRequest '%URL%' -OutFile '%IMG%' -UseBasicParsing } catch {}"
)

if exist "%IMG%" (
    reg add "HKCU\Control Panel\Desktop" /v Wallpaper /t REG_SZ /d "%IMG%" /f >nul
    reg add "HKCU\Control Panel\Desktop" /v WallpaperStyle /t REG_SZ /d 10 /f >nul
    reg add "HKCU\Control Panel\Desktop" /v TileWallpaper /t REG_SZ /d 0 /f >nul
    RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters
)
